@using MaillotStore.Models
@inject NavigationManager NavigationManager
@* IJSRuntime is no longer needed as we removed the "copy" function *@

@if (IsVisible && Product is not null)
{
    <div class="share-modal-overlay" @onclick="CloseModal">
        <div class="share-modal-content" @onclick:stopPropagation="true">
            <h4>Share "@Product.Name"</h4>
            <div class="share-options">
                @* --- All other share icons have been removed --- *@
                <a href="@GetWhatsAppShareLink()" target="_blank" class="share-icon whatsapp">
                    <i class="fab fa-whatsapp"></i>
                </a>
            </div>
            @* --- Removed the "Link Copied" message --- *@
        </div>
    </div>
}

@code {
    [Parameter]
    public Product? Product { get; set; }

    [Parameter]
    public bool IsVisible { get; set; }

    [Parameter]
    public EventCallback OnClose { get; set; }

    private Task CloseModal()
    {
        return OnClose.InvokeAsync();
    }

    private string GetProductUrl()
    {
        return NavigationManager.ToAbsoluteUri($"/product/{Product?.ProductId}").ToString();
    }

    private string GetWhatsAppShareLink()
    {
        if (Product is null) return "";

        var productUrl = GetProductUrl();

        // --- NEW: Message now includes product name and description ---
        var message = $"Check out this product: {Product.Name}\n\n{Product.Description}\n\n{productUrl}";

        return $"https://api.whatsapp.com/send?text={Uri.EscapeDataString(message)}";
    }

    // --- Removed GetFacebookShareLink and CopyLinkForMobile methods ---
}